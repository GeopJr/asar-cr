{"repository_name":"asar-cr","body":"# asar-cr - Electron Archive format for Crystal\n\n[![GitHub release](https://img.shields.io/github/release/GeopJr/asar-cr.svg?style=flat-square)](https://github.com/GeopJr/asar-cr/releases)\n[![GitHub license](https://img.shields.io/badge/license-MIT-blue.svg?style=flat-square)](https://github.com/GeopJr/asar-cr/blob/master/LICENSE)  \n\nRead files from `.asar` archives with built-in caching.\n\nPack and Unpack to and from `.asar` archives.\n\n## Installation\n\nAdd this to your application's `shard.yml`:\n\n```yaml\ndependencies:\n  asar-cr:\n    github: GeopJr/asar-cr\n```\n\n## Usage\n\n#### Reading\n\n```crystal\nrequire \"asar-cr\"\n\nasar = Asar::Reader.new \"path/to/your/archive.asar\"\nio = asar.get \"/awesome/image.png\"\nslice = asar.get_bytes \"/awesome/story.txt\"\n\nasar.files # Returns an Array(String) of all files in the archive.\nasar.files_cached # Returns an Array(String) of all files in the cache.\n\n```\n\n#### Extract\n\n```crystal\nrequire \"asar-cr\"\n\nasar = Asar::Extract.new \"path/to/your/archive.asar\"\n\nasar.extract \"path/to/your/folder\" # Returns true if completed successfully.\n\n```\n\n#### Pack\n\n```crystal\nrequire \"asar-cr\"\n\nasar = Asar::Pack.new \"path/to/your/folder\"\n\nasar.pack \"path/to/your/archive.asar\" # Returns true if completed successfully.\n\n```\n\n## Benchmarks\n\n```\n> crystal run spec/benchmark_read.cr --release\n\n      get   9.33M (107.18ns) (± 5.87%)   96.0B/op    3.23× slower\nget_bytes  30.11M ( 33.22ns) (± 1.18%)    0.0B/op         fastest\n read_raw 280.96k (  3.56µs) (± 6.42%)  8.17kB/op  107.15× slower\n```\n> *Note: Benchmark was done on an SSD and the test [file](spec/test/archive/hello.txt) was small.*\n\nThe methods `get` and `get_bytes` cache a file at first read.  \n- `get` returns an `IO::Memory` created from the cached file  \n- `get_bytes` returns the cached file  \n- `read_raw` reads directly from the files `IO`, bypassing the cache  \n\n```\n> crystal run spec/benchmark_extract.cr --release\n\nextract   4.95k (201.90µs) (± 6.65%)  29.5kB/op  fastest\n```\n> *Note: Couldn't benchmark benchmark_pack.cr due to `Too many open files (File::Error)`.*\n\n## What changed?\n\n1. Updated to latest Crystal version\n2. Use of [Path](https://crystal-lang.org/api/latest/Path.html), allowing cross-platform usage.\n3. Added extract and pack functionality.\n\n## Anyone using it?\n\n1. [Crycord](https://github.com/GeopJr/Crycord): A Discord Client mod\n\n## Contributing\n\n1. Fork it ( https://github.com/GeopJr/asar-cr/fork )\n2. Create your feature branch (git checkout -b my-new-feature)\n3. Commit your changes (git commit -am 'Add some feature')\n4. Push to the branch (git push origin my-new-feature)\n5. Create a new Pull Request\n\n## Contributors\n\n- [GeopJr](https://github.com/GeopJr) Maintainer\n- [petoem](https://github.com/petoem) Michael Petö - Original Creator\n","program":{"html_id":"asar-cr/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"superclass":null,"ancestors":[],"locations":[],"repository_name":"asar-cr","program":true,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"asar-cr/Asar","path":"Asar.html","kind":"module","full_name":"Asar","name":"Asar","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/asar-cr.cr","line_number":3,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr.cr#L3"},{"filename":"src/asar-cr/extract.cr","line_number":3,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L3"},{"filename":"src/asar-cr/header.cr","line_number":3,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L3"},{"filename":"src/asar-cr/pack.cr","line_number":1,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/pack.cr#L1"},{"filename":"src/asar-cr/parser.cr","line_number":1,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/parser.cr#L1"},{"filename":"src/asar-cr/version.cr","line_number":3,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/version.cr#L3"}],"repository_name":"asar-cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[{"id":"VERSION","name":"VERSION","value":"(YAML.parse(::File.read(\"./shard.yml\")))[\"version\"]","doc":null,"summary":null}],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":null,"doc":null,"summary":null,"class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[{"html_id":"asar-cr/Asar/Directory","path":"Asar/Directory.html","kind":"class","full_name":"Asar::Directory","name":"Directory","abstract":false,"superclass":{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"asar-cr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"asar-cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/asar-cr/header.cr","line_number":8,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L8"}],"repository_name":"asar-cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[{"html_id":"asar-cr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"asar-cr/Asar","kind":"module","full_name":"Asar","name":"Asar"},"doc":"A directory contains other `Directory`, `File` or `Link` objects.","summary":"<p>A directory contains other <code><a href=\"../Asar/Directory.html\">Directory</a></code>, <code><a href=\"../Asar/File.html\">File</a></code> or <code><a href=\"../Asar/Link.html\">Link</a></code> objects.</p>","class_methods":[],"constructors":[{"id":"new(pull:JSON::PullParser)-class-method","html_id":"new(pull:JSON::PullParser)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"pull","doc":null,"default_value":"","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L9","def":{"name":"new","args":[{"name":"pull","doc":null,"default_value":"","external_name":"pull","restriction":"::JSON::PullParser"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"new_from_json_pull_parser(pull)"}}],"instance_methods":[{"id":"files:Hash(String,Directory|File|Link)-instance-method","html_id":"files:Hash(String,Directory|File|Link)-instance-method","name":"files","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Hash(String, Directory | File | Link)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L11","def":{"name":"files","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Hash(String, Directory | File | Link)","visibility":"Public","body":"@files"}},{"id":"files=(files:Hash(String,Directory|File|Link))-instance-method","html_id":"files=(files:Hash(String,Directory|File|Link))-instance-method","name":"files=","doc":null,"summary":null,"abstract":false,"args":[{"name":"files","doc":null,"default_value":"","external_name":"files","restriction":"Hash(String, Directory | File | Link)"}],"args_string":"(files : Hash(String, Directory | File | Link))","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L11","def":{"name":"files=","args":[{"name":"files","doc":null,"default_value":"","external_name":"files","restriction":"Hash(String, Directory | File | Link)"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@files = files"}}],"macros":[],"types":[]},{"html_id":"asar-cr/Asar/Extract","path":"Asar/Extract.html","kind":"class","full_name":"Asar::Extract","name":"Extract","abstract":false,"superclass":{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"asar-cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/asar-cr/extract.cr","line_number":11,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L11"}],"repository_name":"asar-cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"asar-cr/Asar","kind":"module","full_name":"Asar","name":"Asar"},"doc":"Enables reading and extracting of files from the given archive with `#get`, `#get_bytes`, `#read_raw` and `#extract`.\n\nFiles are cached automatically when using `#get` or `#get_bytes`; data is stored inside a `Hash`.\nPlease make sure that you have enough memory.\n\nNote: When reading from the archive, you have to use absolute paths.\nThe top level directory of the asar archive is the root. e.g.: `/hello.txt`. Paths are case-sensitive.","summary":"<p>Enables reading and extracting of files from the given archive with <code><a href=\"../Asar/Extract.html#get(path:String):IO::Memory?-instance-method\">#get</a></code>, <code><a href=\"../Asar/Extract.html#get_bytes(path:String):Bytes?-instance-method\">#get_bytes</a></code>, <code><a href=\"../Asar/Extract.html#read_raw(path:String):Bytes?-instance-method\">#read_raw</a></code> and <code><a href=\"../Asar/Extract.html#extract(folder:String):Bool-instance-method\">#extract</a></code>.</p>","class_methods":[],"constructors":[{"id":"new(asar:String)-class-method","html_id":"new(asar:String)-class-method","name":"new","doc":"Creates a new `Extract` for the given archive file.","summary":"<p>Creates a new <code><a href=\"../Asar/Extract.html\">Extract</a></code> for the given archive file.</p>","abstract":false,"args":[{"name":"asar","doc":null,"default_value":"","external_name":"asar","restriction":"String"}],"args_string":"(asar : String)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L19","def":{"name":"new","args":[{"name":"asar","doc":null,"default_value":"","external_name":"asar","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(asar)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"extract(folder:String):Bool-instance-method","html_id":"extract(folder:String):Bool-instance-method","name":"extract","doc":"Extracts the archive to the provided folder.\n\nReturns `true` if successful.","summary":"<p>Extracts the archive to the provided folder.</p>","abstract":false,"args":[{"name":"folder","doc":null,"default_value":"","external_name":"folder","restriction":"String"}],"args_string":"(folder : String) : Bool","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L96","def":{"name":"extract","args":[{"name":"folder","doc":null,"default_value":"","external_name":"folder","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"path = Path[folder].expand(home: true)\n@file_index.each do |key, value|\n  file_path = path.join(key)\n  Dir.mkdir_p(file_path.parent)\n  if value.is_a?(Asar::File)\n    file = get(key)\n    if !file.nil?\n      ::File.write(file_path, file.gets_to_end)\n    end\n  end\nend\n@link_index.each do |key, value|\n  file_path = path.join(key)\n  Dir.mkdir_p(file_path.parent)\n  if value.is_a?(Asar::Link)\n    ::File.symlink((path.join(value.link)).to_s, file_path.to_s)\n  end\nend\ntrue\n"}},{"id":"files-instance-method","html_id":"files-instance-method","name":"files","doc":"Returns an `Array(String)` that contains all files (absolute paths) that are in the archive.","summary":"<p>Returns an <code>Array(String)</code> that contains all files (absolute paths) that are in the archive.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L119","def":{"name":"files","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@file_index.keys"}},{"id":"files_cached-instance-method","html_id":"files_cached-instance-method","name":"files_cached","doc":"Returns an `Array(String)` of all files in the cache.","summary":"<p>Returns an <code>Array(String)</code> of all files in the cache.</p>","abstract":false,"args":[],"args_string":"","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L124","def":{"name":"files_cached","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@file_cache.keys"}},{"id":"get(path:String):IO::Memory?-instance-method","html_id":"get(path:String):IO::Memory?-instance-method","name":"get","doc":"Returns an `IO::Memory` created from the cached file if found.\nElse `Nil`.","summary":"<p>Returns an <code>IO::Memory</code> created from the cached file if found.</p>","abstract":false,"args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"args_string":"(path : String) : IO::Memory?","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L49","def":{"name":"get","args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"IO::Memory | Nil","visibility":"Public","body":"if @file_index[path]?\nelse\n  return\nend\nfile_data = @file_cache[path]?\nif file_data\n  io = IO::Memory.new(file_data, writeable: false)\nelse\n  file_data = read_raw(path)\n  if file_data.nil?\n    return\n  end\n  cache_file(path, file_data)\n  io = IO::Memory.new(file_data, writeable: false)\nend\nio\n"}},{"id":"get_bytes(path:String):Bytes?-instance-method","html_id":"get_bytes(path:String):Bytes?-instance-method","name":"get_bytes","doc":"Returns the cached file if found.\nElse `Nil`.","summary":"<p>Returns the cached file if found.</p>","abstract":false,"args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"args_string":"(path : String) : Bytes?","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L66","def":{"name":"get_bytes","args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bytes | Nil","visibility":"Public","body":"if @file_index[path]?\nelse\n  return\nend\nfile_data = @file_cache[path]?\nif file_data\nelse\n  file_data = read_raw(path)\n  cache_file(path, file_data)\nend\nfile_data\n"}},{"id":"header:Header-instance-method","html_id":"header:Header-instance-method","name":"header","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Header","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L13","def":{"name":"header","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Header","visibility":"Public","body":"@header"}},{"id":"header=(header:Header)-instance-method","html_id":"header=(header:Header)-instance-method","name":"header=","doc":null,"summary":null,"abstract":false,"args":[{"name":"header","doc":null,"default_value":"","external_name":"header","restriction":"Header"}],"args_string":"(header : Header)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L13","def":{"name":"header=","args":[{"name":"header","doc":null,"default_value":"","external_name":"header","restriction":"Header"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@header = header"}},{"id":"index_info(file:String):Asar::File?-instance-method","html_id":"index_info(file:String):Asar::File?-instance-method","name":"index_info","doc":"Return the `Asar::File`, if found.\nElse raises `Nil`.","summary":"<p>Return the <code><a href=\"../Asar/File.html\">Asar::File</a></code>, if found.</p>","abstract":false,"args":[{"name":"file","doc":null,"default_value":"","external_name":"file","restriction":"String"}],"args_string":"(file : String) : Asar::File?","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L41","def":{"name":"index_info","args":[{"name":"file","doc":null,"default_value":"","external_name":"file","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Asar::File | Nil","visibility":"Public","body":"if @file_index[file]?\nelse\n  return\nend\n@file_index[file]?\n"}},{"id":"io:::File-instance-method","html_id":"io:::File-instance-method","name":"io","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : ::File","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L12","def":{"name":"io","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"::File","visibility":"Public","body":"@io"}},{"id":"io=(io:::File)-instance-method","html_id":"io=(io:::File)-instance-method","name":"io=","doc":null,"summary":null,"abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"::File"}],"args_string":"(io : ::File)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L12","def":{"name":"io=","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"::File"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@io = io"}},{"id":"read_raw(path:String):Bytes?-instance-method","html_id":"read_raw(path:String):Bytes?-instance-method","name":"read_raw","doc":"Reads directly from the files `IO`, bypassing the cache if found.\nElse `Nil`.","summary":"<p>Reads directly from the files <code>IO</code>, bypassing the cache if found.</p>","abstract":false,"args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"args_string":"(path : String) : Bytes?","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/extract.cr#L79","def":{"name":"read_raw","args":[{"name":"path","doc":null,"default_value":"","external_name":"path","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bytes | Nil","visibility":"Public","body":"file = @file_index[path]?\nif file\nelse\n  return\nend\nsize = file.size\noffset = file.offset\nif size.nil? || offset.nil?\n  return\nend\nfile_data = Bytes.new(size)\n@io.read_at(@header.length + offset.to_i32, size) do |data|\n  data.read_fully(file_data)\nend\nfile_data\n"}}],"macros":[],"types":[]},{"html_id":"asar-cr/Asar/File","path":"Asar/File.html","kind":"class","full_name":"Asar::File","name":"File","abstract":false,"superclass":{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"asar-cr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"asar-cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/asar-cr/header.cr","line_number":15,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L15"}],"repository_name":"asar-cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[{"html_id":"asar-cr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"asar-cr/Asar","kind":"module","full_name":"Asar","name":"Asar"},"doc":"A `File` contains the size, offset and executable flag stored inside the archive header.","summary":"<p>A <code><a href=\"../Asar/File.html\">File</a></code> contains the size, offset and executable flag stored inside the archive header.</p>","class_methods":[],"constructors":[{"id":"new(pull:JSON::PullParser)-class-method","html_id":"new(pull:JSON::PullParser)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"pull","doc":null,"default_value":"","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L16","def":{"name":"new","args":[{"name":"pull","doc":null,"default_value":"","external_name":"pull","restriction":"::JSON::PullParser"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"new_from_json_pull_parser(pull)"}}],"instance_methods":[{"id":"executable:Bool?-instance-method","html_id":"executable:Bool?-instance-method","name":"executable","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Bool?","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L20","def":{"name":"executable","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool | ::Nil","visibility":"Public","body":"@executable"}},{"id":"executable=(executable:Bool?)-instance-method","html_id":"executable=(executable:Bool?)-instance-method","name":"executable=","doc":null,"summary":null,"abstract":false,"args":[{"name":"executable","doc":null,"default_value":"","external_name":"executable","restriction":"Bool | ::Nil"}],"args_string":"(executable : Bool?)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L20","def":{"name":"executable=","args":[{"name":"executable","doc":null,"default_value":"","external_name":"executable","restriction":"Bool | ::Nil"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@executable = executable"}},{"id":"offset:String-instance-method","html_id":"offset:String-instance-method","name":"offset","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L19","def":{"name":"offset","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@offset"}},{"id":"offset=(offset:String)-instance-method","html_id":"offset=(offset:String)-instance-method","name":"offset=","doc":null,"summary":null,"abstract":false,"args":[{"name":"offset","doc":null,"default_value":"","external_name":"offset","restriction":"String"}],"args_string":"(offset : String)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L19","def":{"name":"offset=","args":[{"name":"offset","doc":null,"default_value":"","external_name":"offset","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@offset = offset"}},{"id":"size:Int32-instance-method","html_id":"size:Int32-instance-method","name":"size","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : Int32","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L18","def":{"name":"size","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Int32","visibility":"Public","body":"@size"}},{"id":"size=(size:Int32)-instance-method","html_id":"size=(size:Int32)-instance-method","name":"size=","doc":null,"summary":null,"abstract":false,"args":[{"name":"size","doc":null,"default_value":"","external_name":"size","restriction":"Int32"}],"args_string":"(size : Int32)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L18","def":{"name":"size=","args":[{"name":"size","doc":null,"default_value":"","external_name":"size","restriction":"Int32"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@size = size"}}],"macros":[],"types":[]},{"html_id":"asar-cr/Asar/Header","path":"Asar/Header.html","kind":"struct","full_name":"Asar::Header","name":"Header","abstract":false,"superclass":{"html_id":"asar-cr/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"asar-cr/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"asar-cr/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"asar-cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/asar-cr/header.cr","line_number":31,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L31"}],"repository_name":"asar-cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"asar-cr/Asar","kind":"module","full_name":"Asar","name":"Asar"},"doc":"`Header` contains the asar archive header data and length.","summary":"<p><code><a href=\"../Asar/Header.html\">Header</a></code> contains the asar archive header data and length.</p>","class_methods":[],"constructors":[{"id":"new(data:Archive,length:Int32)-class-method","html_id":"new(data:Archive,length:Int32)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"data","doc":null,"default_value":"","external_name":"data","restriction":"Archive"},{"name":"length","doc":null,"default_value":"","external_name":"length","restriction":"Int32"}],"args_string":"(data : Archive, length : Int32)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L37","def":{"name":"new","args":[{"name":"data","doc":null,"default_value":"","external_name":"data","restriction":"Archive"},{"name":"length","doc":null,"default_value":"","external_name":"length","restriction":"Int32"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(data, length)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"data:Archive-instance-method","html_id":"data:Archive-instance-method","name":"data","doc":"Archive that contains `File` and `Directory` information.","summary":"<p>Archive that contains <code><a href=\"../Asar/File.html\">File</a></code> and <code><a href=\"../Asar/Directory.html\">Directory</a></code> information.</p>","abstract":false,"args":[],"args_string":" : Archive","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L35","def":{"name":"data","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Archive","visibility":"Public","body":"@data"}},{"id":"length:Int32-instance-method","html_id":"length:Int32-instance-method","name":"length","doc":"Header length needed for offset calculation.","summary":"<p>Header length needed for offset calculation.</p>","abstract":false,"args":[],"args_string":" : Int32","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L33","def":{"name":"length","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Int32","visibility":"Public","body":"@length"}}],"macros":[],"types":[]},{"html_id":"asar-cr/Asar/Link","path":"Asar/Link.html","kind":"class","full_name":"Asar::Link","name":"Link","abstract":false,"superclass":{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"asar-cr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"},{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"asar-cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/asar-cr/header.cr","line_number":24,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L24"}],"repository_name":"asar-cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[{"html_id":"asar-cr/JSON/Serializable","kind":"module","full_name":"JSON::Serializable","name":"Serializable"}],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"asar-cr/Asar","kind":"module","full_name":"Asar","name":"Asar"},"doc":"A `Link` contains the link flag stored inside the archive header.","summary":"<p>A <code><a href=\"../Asar/Link.html\">Link</a></code> contains the link flag stored inside the archive header.</p>","class_methods":[],"constructors":[{"id":"new(pull:JSON::PullParser)-class-method","html_id":"new(pull:JSON::PullParser)-class-method","name":"new","doc":null,"summary":null,"abstract":false,"args":[{"name":"pull","doc":null,"default_value":"","external_name":"pull","restriction":"::JSON::PullParser"}],"args_string":"(pull : JSON::PullParser)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L25","def":{"name":"new","args":[{"name":"pull","doc":null,"default_value":"","external_name":"pull","restriction":"::JSON::PullParser"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"new_from_json_pull_parser(pull)"}}],"instance_methods":[{"id":"link:String-instance-method","html_id":"link:String-instance-method","name":"link","doc":null,"summary":null,"abstract":false,"args":[],"args_string":" : String","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L27","def":{"name":"link","args":[],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"String","visibility":"Public","body":"@link"}},{"id":"link=(link:String)-instance-method","html_id":"link=(link:String)-instance-method","name":"link=","doc":null,"summary":null,"abstract":false,"args":[{"name":"link","doc":null,"default_value":"","external_name":"link","restriction":"String"}],"args_string":"(link : String)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/header.cr#L27","def":{"name":"link=","args":[{"name":"link","doc":null,"default_value":"","external_name":"link","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"@link = link"}}],"macros":[],"types":[]},{"html_id":"asar-cr/Asar/Pack","path":"Asar/Pack.html","kind":"class","full_name":"Asar::Pack","name":"Pack","abstract":false,"superclass":{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"asar-cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/asar-cr/pack.cr","line_number":3,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/pack.cr#L3"}],"repository_name":"asar-cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"asar-cr/Asar","kind":"module","full_name":"Asar","name":"Asar"},"doc":"Enables packing of files from the given archive with `#pack`.","summary":"<p>Enables packing of files from the given archive with <code><a href=\"../Asar/Pack.html#pack(asar:String):Bool-instance-method\">#pack</a></code>.</p>","class_methods":[],"constructors":[{"id":"new(folder:String)-class-method","html_id":"new(folder:String)-class-method","name":"new","doc":"Creates a new `Pack` from the given folder.","summary":"<p>Creates a new <code><a href=\"../Asar/Pack.html\">Pack</a></code> from the given folder.</p>","abstract":false,"args":[{"name":"folder","doc":null,"default_value":"","external_name":"folder","restriction":"String"}],"args_string":"(folder : String)","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/pack.cr#L12","def":{"name":"new","args":[{"name":"folder","doc":null,"default_value":"","external_name":"folder","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"","visibility":"Public","body":"_ = allocate\n_.initialize(folder)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"id":"pack(asar:String):Bool-instance-method","html_id":"pack(asar:String):Bool-instance-method","name":"pack","doc":"Packs the folder into the provided archive.\n\nReturns `true` if successful.","summary":"<p>Packs the folder into the provided archive.</p>","abstract":false,"args":[{"name":"asar","doc":null,"default_value":"","external_name":"asar","restriction":"String"}],"args_string":"(asar : String) : Bool","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/pack.cr#L61","def":{"name":"pack","args":[{"name":"asar","doc":null,"default_value":"","external_name":"asar","restriction":"String"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Bool","visibility":"Public","body":"header = (header_builder(@path)).to_json\nheader_string_size = header.size\ndata_size = 4_u32\naligned_size = round_up(header_string_size, data_size)\nheader_size = aligned_size + 8\nheader_object_size = aligned_size + data_size\ndiff = aligned_size - header_string_size\nheader = diff > 0 ? header + (\"0\" * diff) : header\nnum = [data_size, header_size, header_object_size, header_string_size]\nio = IO::Memory.new\nnum.each do |n|\n  io.write_bytes(n.to_i32, IO::ByteFormat::LittleEndian)\nend\nio << header\nio << @packed_files\nio.rewind\npath = Path[asar].expand(home: true).to_s\n::File.write(path + (path.ends_with?(\".asar\") ? \"\" : \".asar\"), io, mode: \"wb\")\ntrue\n"}}],"macros":[],"types":[{"html_id":"asar-cr/Asar/Pack/HeaderData","path":"Asar/Pack/HeaderData.html","kind":"alias","full_name":"Asar::Pack::HeaderData","name":"HeaderData","abstract":false,"superclass":null,"ancestors":[],"locations":[{"filename":"src/asar-cr/pack.cr","line_number":5,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/pack.cr#L5"}],"repository_name":"asar-cr","program":false,"enum":false,"alias":true,"aliased":"(Hash(String, Asar::Pack::HeaderData) | String | UInt64)","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"asar-cr/Asar/Pack","kind":"class","full_name":"Asar::Pack","name":"Pack"},"doc":"A recursive hash used to generate the header","summary":"<p>A recursive hash used to generate the header</p>","class_methods":[],"constructors":[],"instance_methods":[],"macros":[],"types":[]}]},{"html_id":"asar-cr/Asar/Parser","path":"Asar/Parser.html","kind":"class","full_name":"Asar::Parser","name":"Parser","abstract":false,"superclass":{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"asar-cr/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"asar-cr/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/asar-cr/parser.cr","line_number":3,"url":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/parser.cr#L3"}],"repository_name":"asar-cr","program":false,"enum":false,"alias":false,"aliased":"","const":false,"constants":[],"included_modules":[],"extended_modules":[],"subclasses":[],"including_types":[],"namespace":{"html_id":"asar-cr/Asar","kind":"module","full_name":"Asar","name":"Asar"},"doc":"Is responsible for reading and parsing the archive header.","summary":"<p>Is responsible for reading and parsing the archive header.</p>","class_methods":[{"id":"parse(io:IO::FileDescriptor):Header-class-method","html_id":"parse(io:IO::FileDescriptor):Header-class-method","name":"parse","doc":"Expects a readable `IO::FileDescriptor` to read the archive header from.\n\nReturns a new `Header` populated with the archives header.","summary":"<p>Expects a readable <code>IO::FileDescriptor</code> to read the archive header from.</p>","abstract":false,"args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO::FileDescriptor"}],"args_string":"(io : IO::FileDescriptor) : Header","source_link":"https://github.com/GeopJr/asar-cr/blob/2b99db7c483e70e709f90032a80a0bedb91437bf/src/asar-cr/parser.cr#L7","def":{"name":"parse","args":[{"name":"io","doc":null,"default_value":"","external_name":"io","restriction":"IO::FileDescriptor"}],"double_splat":null,"splat_index":null,"yields":null,"block_arg":null,"return_type":"Header","visibility":"Public","body":"if io.info.size < 16\n  raise(\"Can't parse, not enough data!\")\nend\nio.rewind\npayload_size = Int32.from_io(io, IO::ByteFormat::LittleEndian)\npayload_offset = 8 - payload_size\nio.pos = payload_offset\nheader_length = Int32.from_io(io, IO::ByteFormat::LittleEndian)\nio.pos = 8\nheader_payload_size = Int32.from_io(io, IO::ByteFormat::LittleEndian)\nheader_payload_offset = header_length - header_payload_size\nio.pos = 8 + header_payload_offset\ndata_table_size = Int32.from_io(io, IO::ByteFormat::LittleEndian)\nio.pos = 16\nheader_data = Bytes.new(data_table_size)\nio.read(header_data)\nasar_data_offset = 8 + header_length\nbegin\n  header = Archive.from_json(String.new(header_data))\nrescue exception\n  raise(\"#{exception.class} #{exception}\")\nend\nHeader.new(header, asar_data_offset)\n"}}],"constructors":[],"instance_methods":[],"macros":[],"types":[]}]}]}}